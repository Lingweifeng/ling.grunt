/*! ling.grunt - v1.0.0 - 2017-02-08 */var Choice={$commandShop:$("#commandShop"),$posName:$("#posName"),renderCommondList:function(a){var b=this;$.each(a,function(a,c){b.$commandShop.append('<a href="'+c.url+'" class="item"><h3><i style="background-color:'+c.color+'"></i><b>'+c.name+'</b></h3><p><i class="icon pos"></i>'+(0===a?"推荐前往":"距您"+c.distance+"公里")+"</p></a>")})},init:function(){var a=this,b=[],c=new BMap.Map("Map");c.enableScrollWheelZoom(),c.enableContinuousZoom();var d=[{name:"德克士（江宁店）",color:"#f66bb1",lng:121.461792,lat:31.236026,url:"#"},{name:"德克士（七宝店）",color:"#5fc0f8",lng:121.353822,lat:31.162626,url:"#"},{name:"德克士（锦绣路店）",color:"#eb711c",lng:121.547724,lat:31.186031,url:"#"},{name:"德克士（南站店）",color:"#5ce8c4",lng:121.435221,lat:31.158786,url:"#"}];$.each(d,function(a,b){var d=new BMap.Point(b.lng,b.lat),e=new BMap.Circle(d,800,{strokeColor:b.color,fillColor:b.color,strokeWeight:1,strokeOpacity:1,fillOpacity:1});c.addOverlay(e)}),c.centerAndZoom(new BMap.Point(d[0].lng,d[0].lat),11);var e=new BMap.Geolocation;e.getCurrentPosition(function(e){if(this.getStatus()==BMAP_STATUS_SUCCESS){var f=new BMap.Marker(e.point);c.addOverlay(f),f.setAnimation(BMAP_ANIMATION_BOUNCE),c.panTo(e.point),$.each(d,function(a,d){var f=c.getDistance(e.point,new BMap.Point(d.lng,d.lat)),g=(f/1e3).toFixed(2);b.push(g),d.distance=g});var g=d.sort(function(a,b){return a.distance-b.distance});console.log(g),a.renderCommondList(g)}else alert("failed"+this.getStatus())},{enableHighAccuracy:!0})}};$(function(){Choice.init()});